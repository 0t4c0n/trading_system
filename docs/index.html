<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aggressive Momentum Trading Bot - AnÃ¡lisis Semanal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Inter', sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #2563eb 100%);
            min-height: 100vh;
            padding: 10px;
            color: #1f2937;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1f2937, #374151);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #3b82f6;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 100%;
        }
        
        .title-section {
            flex: 1;
            text-align: left;
        }
        
        .header h1 {
            font-size: 1.6em;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .header .subtitle {
            opacity: 0.95;
            font-size: 0.95em;
            font-weight: 500;
        }
        
        .creator-section {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 16px;
            border-radius: 25px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        .creator-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            /* Preparado para imagen manual */
        }
        
        .creator-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .creator-info {
            text-align: right;
            line-height: 1.2;
        }
        
        .creator-name {
            font-weight: bold;
            font-size: 1.1em;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .creator-label {
            font-size: 0.8em;
            opacity: 0.9;
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .summary {
            padding: 15px 20px;
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-bottom: 1px solid #cbd5e1;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 15px;
            text-align: center;
        }
        
        .summary-item {
            background: white;
            padding: 12px 8px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #3b82f6;
            border-top: 1px solid #e2e8f0;
        }
        
        .summary-number {
            font-size: 1.9em;
            font-weight: 700;
        }
        
        .summary-number.momentum {
            color: #2563eb;
        }
        
        .summary-number.aggressive {
            color: #059669;
        }
        
        .summary-number.rotation {
            color: #7c3aed;
        }
        
        .summary-number.targeting {
            color: #dc2626;
        }
        
        .summary-label {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
            font-weight: 500;
        }
        
        .momentum-philosophy {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: 15px 20px;
            border-left: 5px solid #3b82f6;
            margin: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .momentum-philosophy h3 {
            color: #1e40af;
            margin-bottom: 10px;
            font-size: 1.1em;
            font-weight: 600;
        }
        
        .momentum-weights {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 10px;
        }
        
        .weight-item {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #3b82f6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .weight-value {
            font-size: 1.4em;
            font-weight: 700;
            color: #1d4ed8;
        }
        
        .weight-label {
            font-size: 0.8em;
            color: #666;
            margin-top: 3px;
        }
        
        .analysis-sections {
            padding: 20px;
            display: grid;
            gap: 20px;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .section-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: "ðŸš€";
            margin-right: 8px;
        }
        
        .section-title.picks::before {
            content: "âš¡";
        }
        
        .section-title.momentum::before {
            content: "ðŸ”¥";
        }
        
        .section-title.rotation::before {
            content: "ðŸŽ¯";
        }
        
        .analysis-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            border-left: 4px solid #3b82f6;
            border-top: 1px solid #e5e7eb;
        }
        
        .top-picks-grid {
            display: grid;
            gap: 15px;
        }
        
        .pick-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 15px;
            border-left: 4px solid #3b82f6;
            position: relative;
            border: 1px solid #e5e7eb;
        }
        
        .pick-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .pick-symbol {
            font-size: 1.4em;
            font-weight: 700;
            color: #1e40af;
        }
        
        .pick-price {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .pick-company {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .momentum-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
            margin: 10px 0;
        }
        
        .momentum-badge {
            background: #3b82f6;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7em;
            font-weight: 600;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .momentum-badge.exceptional {
            background: #dc2626;
        }
        
        .momentum-badge.strong {
            background: #059669;
        }
        
        .momentum-badge.moderate {
            background: #7c3aed;
        }
        
        .momentum-badge.weak {
            background: #6b7280;
        }
        
        .trading-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        
        .level-item {
            background: white;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #d1d5db;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .level-value {
            font-weight: 600;
            font-size: 0.9em;
        }
        
        .level-value.stop-loss {
            color: #dc2626;
        }
        
        .level-value.take-profit {
            color: #059669;
        }
        
        .level-value.current {
            color: #2563eb;
        }
        
        .level-value.aggressive {
            color: #7c3aed;
            font-size: 1.0em;
            font-weight: 700;
        }
        
        .level-label {
            font-size: 0.7em;
            color: #666;
            margin-top: 2px;
        }
        
        .pick-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }
        
        .metric-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 6px;
            border-radius: 6px;
            text-align: center;
        }
        
        .metric-value {
            font-weight: bold;
            font-size: 0.8em;
        }
        
        .metric-label {
            font-size: 0.6em;
            color: #666;
        }
        
        .pick-reasoning {
            background: rgba(59, 130, 246, 0.08);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
        }
        
        .reasoning-title {
            font-weight: 600;
            color: #1e40af;
            font-size: 0.8em;
            margin-bottom: 5px;
        }
        
        .reasoning-text {
            font-size: 0.8em;
            color: #374151;
            line-height: 1.3;
        }
        
        .momentum-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .momentum-item {
            background: #f8fafc;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .momentum-number {
            font-size: 1.5em;
            font-weight: 700;
            color: #2563eb;
        }
        
        .momentum-label {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }
        
        .symbol-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .symbol-badge {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .symbol-badge.exceptional {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
        }
        
        .symbol-badge.strong {
            background: linear-gradient(135deg, #059669, #047857);
        }
        
        .symbol-badge.emerging {
            background: linear-gradient(135deg, #7c3aed, #6d28d9);
        }
        
        .rotation-section {
            margin-bottom: 15px;
        }
        
        .rotation-title {
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .rotation-title.urgent::before {
            content: "ðŸš¨";
            margin-right: 8px;
        }
        
        .rotation-title.aggressive::before {
            content: "âš¡";
            margin-right: 8px;
        }
        
        .rotation-title.emerging::before {
            content: "ðŸŒ±";
            margin-right: 8px;
        }
        
        .rotation-title.hold::before {
            content: "âœ…";
            margin-right: 8px;
        }
        
        .rotation-recommendations {
            display: grid;
            gap: 12px;
        }
        
        .recommendation-item {
            background: #f8fafc;
            border-radius: 10px;
            padding: 12px;
            border-left: 4px solid #3b82f6;
            border: 1px solid #e5e7eb;
        }
        
        .recommendation-item.urgent {
            border-left-color: #dc2626;
            background: #fef2f2;
            border-color: #fecaca;
        }
        
        .recommendation-item.aggressive {
            border-left-color: #059669;
            background: #f0fdf4;
            border-color: #bbf7d0;
        }
        
        .recommendation-item.emerging {
            border-left-color: #7c3aed;
            background: #faf5ff;
            border-color: #e9d5ff;
        }
        
        .recommendation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .recommendation-symbol {
            font-weight: 600;
            color: #1f2937;
        }
        
        .recommendation-action {
            font-size: 0.8em;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
            background: #3b82f6;
            color: white;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .recommendation-action.urgent {
            background: #dc2626;
        }
        
        .recommendation-action.aggressive {
            background: #059669;
        }
        
        .recommendation-action.emerging {
            background: #7c3aed;
        }
        
        .recommendation-reason {
            font-size: 0.85em;
            color: #666;
            line-height: 1.3;
        }
        
        .action-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
            margin: 4px 8px 4px 0;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .action-badge.maintain {
            background: #f0fdf4;
            color: #15803d;
            border: 1px solid #bbf7d0;
        }
        
        .action-badge.evaluate {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }
        
        .action-badge.rotation-required {
            background: #fef2f2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        
        .action-badge.urgent-rotation {
            background: #faf5ff;
            color: #7c3aed;
            border: 1px solid #e9d5ff;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .market-context {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .market-context h4 {
            margin-bottom: 10px;
            color: #1e40af;
            font-weight: 600;
        }
        
        .spy-metrics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .spy-metric {
            background: white;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .spy-value {
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .spy-value.positive {
            color: #059669;
        }
        
        .spy-value.negative {
            color: #dc2626;
        }
        
        .spy-label {
            font-size: 0.8em;
            color: #666;
            margin-top: 2px;
        }
        
        .last-update {
            text-align: center;
            padding: 15px;
            font-size: 0.8em;
            color: #6b7280;
            background: #f8fafc;
            border-top: 1px solid #e5e7eb;
        }
        
        .signature {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #d1d5db;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 600;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        
        .error {
            background: #fef2f2;
            color: #dc2626;
            padding: 15px;
            border-radius: 8px;
            margin: 20px;
            text-align: center;
            border: 1px solid #fecaca;
        }
        
        .refresh-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #3b82f6;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2em;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .refresh-btn:hover {
            transform: scale(1.1);
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .trading-levels {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .title-section {
                text-align: center;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                margin: 5px;
                border-radius: 15px;
            }
            
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .pick-metrics {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .trading-levels {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="title-section">
                    <h1>ðŸ“Š Professional Momentum Analytics</h1>
                    <div class="subtitle">Advanced Trading Intelligence - Dynamic Rotation</div>
                </div>
                <div class="creator-section">
                    <div class="creator-avatar">
                        <!-- Avatar preparado para inserciÃ³n manual -->
                    </div>
                    <div class="creator-info">
                        <div class="creator-name">0t4c0n</div>
                        <div class="creator-label">Creator</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="momentum-philosophy">
            <h3>ðŸŽ¯ Investment Philosophy: Dynamic Momentum Allocation</h3>
            <div style="font-size: 0.9em; margin-bottom: 10px;">
                Systematic momentum detection with monthly rotation optimization. Targeting institutional-grade risk-adjusted returns through data-driven position management.
            </div>
            <div class="momentum-weights">
                <div class="weight-item">
                    <div class="weight-value">70%</div>
                    <div class="weight-label">Momentum 20d</div>
                </div>
                <div class="weight-item">
                    <div class="weight-value">30%</div>
                    <div class="weight-label">Momentum 60d</div>
                </div>
            </div>
        </div>
        
        <div id="content">
            <div class="loading">
                <div>ðŸ“Š Loading professional momentum analytics with dynamic rotation models...</div>
            </div>
        </div>
    </div>
    
    <button class="refresh-btn" onclick="loadData()" title="Actualizar datos">
        ðŸ”„
    </button>

    <script>
        function getNextUpdateTime() {
            const now = new Date();
            const nextSaturday = new Date(now);
            
            const daysUntilSaturday = (6 - now.getDay() + 7) % 7;
            if (daysUntilSaturday === 0 && now.getHours() < 10) {
                nextSaturday.setHours(10, 0, 0, 0);
            } else {
                nextSaturday.setDate(now.getDate() + (daysUntilSaturday || 7));
                nextSaturday.setHours(10, 0, 0, 0);
            }
            
            return nextSaturday.toLocaleString('es-ES', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function calculateAggressiveTradingLevels(stock) {
            const currentPrice = stock.price || stock.current_price || 0;
            const stopLoss = stock.stop_loss || (currentPrice * 0.90); // 10% default para momentum
            
            // Take Profit mÃ¡s agresivo basado en momentum category
            let takeProfit = currentPrice;
            const momentumCategory = stock.momentum_category || 'MODERATE';
            
            // Sistema agresivo basado en categorÃ­a de momentum
            if (momentumCategory === 'EXCEPTIONAL') {
                takeProfit = currentPrice * 1.45; // 45% target agresivo
            } else if (momentumCategory === 'STRONG') {
                takeProfit = currentPrice * 1.35; // 35% target
            } else if (momentumCategory === 'MODERATE') {
                takeProfit = currentPrice * 1.25; // 25% target
            } else {
                takeProfit = currentPrice * 1.18; // 18% conservador
            }
            
            // Aplicar sistema ATR si estÃ¡ disponible
            const atr = stock.atr || (currentPrice * 0.04); // 4% default ATR para momentum
            const atrBasedTarget = currentPrice + (atr * getATRMultiplier(stock.score || 0));
            
            // Usar el mÃ¡s agresivo para momentum trading
            takeProfit = Math.max(takeProfit, atrBasedTarget);
            
            return {
                current: currentPrice,
                stopLoss: stopLoss,
                takeProfit: takeProfit,
                riskReward: ((takeProfit - currentPrice) / (currentPrice - stopLoss)).toFixed(2),
                targetMethod: 'aggressive_momentum'
            };
        }
        
        function getATRMultiplier(score) {
            // Multiplicadores ATR mÃ¡s agresivos
            if (score > 100) return 3.5; // Era 3.0
            if (score >= 60) return 2.8;  // Era 2.5
            return 2.3; // Era 2.0
        }
        
        function getMomentumCategory(stock) {
            // Determinar categorÃ­a de momentum basada en datos disponibles
            const score = stock.score || 0;
            const momentum20d = stock.metrics?.outperformance_20d || 0;
            const momentum60d = stock.metrics?.outperformance_60d || 0;
            
            if (score > 200 || momentum20d > 25) return 'EXCEPTIONAL';
            if (score > 150 || momentum20d > 15) return 'STRONG';
            if (score > 100 || momentum20d > 8) return 'MODERATE';
            if (score > 50) return 'WEAK';
            return 'POOR';
        }
        
        function generateAggressiveReasoningText(stock, momentum) {
            let reasoning = [];
            
            // AnÃ¡lisis de momentum
            const momentumCategory = getMomentumCategory(stock);
            if (momentumCategory === 'EXCEPTIONAL') {
                reasoning.push(`Momentum EXCEPCIONAL detectado - rotaciÃ³n urgente recomendada`);
            } else if (momentumCategory === 'STRONG') {
                reasoning.push(`Momentum FUERTE - candidato para rotaciÃ³n agresiva`);
            }
            
            // Momentum 20d (peso 70%)
            const momentum20d = stock.metrics?.outperformance_20d || 0;
            if (momentum20d > 20) {
                reasoning.push(`Momentum 20d excepcional: +${momentum20d.toFixed(1)}% (peso 70%)`);
            } else if (momentum20d > 10) {
                reasoning.push(`Momentum 20d fuerte: +${momentum20d.toFixed(1)}% (peso 70%)`);
            }
            
            // Risk/Reward agresivo
            const risk = stock.metrics?.risk_pct || 0;
            const rr = stock.metrics?.risk_reward_ratio || 0;
            if (rr > 3.0) {
                reasoning.push(`R/R excepcional: ${rr.toFixed(1)}:1 con riesgo ${risk.toFixed(1)}%`);
            }
            
            // Score breakdown
            const technicalScore = stock.technical_score || 0;
            const rrBonus = stock.rr_bonus || 0;
            if (rrBonus > 20) {
                reasoning.push(`Score tÃ©cnico ${technicalScore.toFixed(0)} + bonus R/R ${rrBonus.toFixed(0)}`);
            }
            
            // Acceleration signals
            if (stock.appeared_this_week && stock.frequency >= 2) {
                reasoning.push(`Acceleration: aparece esta semana + ${stock.frequency} semanas consistencia`);
            }
            
            if (reasoning.length === 0) {
                reasoning.push(`AnÃ¡lisis momentum: categorÃ­a ${momentumCategory}, target ~1 mes rotaciÃ³n`);
            }
            
            return reasoning.join(". ");
        }
        
        async function loadData() {
            try {
                const response = await fetch('data.json');
                if (!response.ok) throw new Error('No se pudieron cargar los datos');
                
                const data = await response.json();
                renderAggressiveMomentumDashboard(data);
                
            } catch (error) {
                console.error('Error loading data:', error);
                
                // Fallback con datos de ejemplo agresivos
                const fallbackData = {
                    "timestamp": new Date().toISOString(),
                    "market_date": new Date().toISOString().split('T')[0],
                    "summary": {
                        "analysis_type": "Aggressive Momentum Responsive",
                        "total_analyzed": 180,
                        "passed_filters": 15,
                        "exceptional_momentum": 3,
                        "strong_momentum": 6,
                        "rotation_opportunities": 8,
                        "message": "Testing local - Datos agresivos con momentum responsivo"
                    },
                    "top_picks": [
                        {
                            "rank": 1,
                            "symbol": "TTMI",
                            "company": "TTM Technologies Inc",
                            "sector": "Technology Hardware",
                            "price": 198.50,
                            "score": 387.2,
                            "technical_score": 342.1,
                            "rr_bonus": 45.1,
                            "stop_loss": 178.65,
                            "take_profit": 287.75,
                            "momentum_category": "EXCEPTIONAL",
                            "metrics": {
                                "risk_pct": 9.8,
                                "upside_pct": 45.0,
                                "risk_reward_ratio": 4.6,
                                "outperformance_20d": 28.5,
                                "outperformance_60d": 65.2,
                                "volume_surge": 67.3,
                                "momentum_strength": 95
                            },
                            "target_hold": "~1 mes (rotaciÃ³n agresiva)",
                            "rotation_urgency": "URGENT"
                        },
                        {
                            "rank": 2,
                            "symbol": "NVDA",
                            "company": "NVIDIA Corporation",
                            "sector": "Semiconductors",
                            "price": 845.20,
                            "score": 356.8,
                            "technical_score": 312.4,
                            "rr_bonus": 44.4,
                            "stop_loss": 760.68,
                            "take_profit": 1141.02,
                            "momentum_category": "STRONG",
                            "metrics": {
                                "risk_pct": 10.0,
                                "upside_pct": 35.0,
                                "risk_reward_ratio": 3.5,
                                "outperformance_20d": 22.1,
                                "outperformance_60d": 78.4,
                                "volume_surge": 45.2,
                                "momentum_strength": 88
                            },
                            "target_hold": "~1 mes (rotaciÃ³n agresiva)",
                            "rotation_urgency": "HIGH"
                        }
                    ],
                    "momentum_analysis": {
                        "philosophy": "swing_for_fences_monthly_rotation",
                        "momentum_weights": {
                            "momentum_20d": 0.70,
                            "momentum_60d": 0.30
                        },
                        "exceptional_momentum": ["TTMI", "NVDA", "QGEN"],
                        "strong_momentum": ["SOFI", "ADNT", "META"],
                        "emerging_momentum": ["ASML", "NOW", "CRM"]
                    },
                    "rotation_recommendations": {
                        "overall_action": "URGENT_PORTFOLIO_ROTATION",
                        "aggressive_rotations": ["TTMI", "NVDA"],
                        "urgent_exits": ["PLAY"],
                        "emerging_opportunities": ["QGEN", "ASML"],
                        "detailed_recommendations": [
                            {
                                "symbol": "TTMI",
                                "action": "URGENT_ROTATION",
                                "reason": "Momentum excepcional (95/100) + acceleration signals + R/R 4.6:1",
                                "urgency": "URGENT",
                                "momentum_category": "EXCEPTIONAL"
                            }
                        ]
                    },
                    "market_context": {
                        "spy_20d": 1.8,
                        "spy_60d": 6.2,
                        "spy_90d": 11.1
                    }
                };
                
                console.log('Usando datos de fallback agresivos para testing local');
                renderAggressiveMomentumDashboard(fallbackData);
                
                const errorInfo = document.createElement('div');
                errorInfo.innerHTML = `
                    <div style="background: #fff3e0; border: 1px solid #ffb74d; border-radius: 8px; padding: 15px; margin: 20px; color: #ef6c00;">
                        <strong>âš¡ Modo Testing Agresivo - Datos de Ejemplo</strong><br>
                        <small>
                            Se muestran datos de ejemplo con momentum agresivo y rotaciÃ³n mensual.<br>
                            Para datos reales, ejecuta desde servidor HTTP con archivos del bot.<br>
                        </small>
                    </div>
                `;
                document.getElementById('content').appendChild(errorInfo);
            }
        }
        
        function renderAggressiveMomentumDashboard(data) {
            const contentEl = document.getElementById('content');
            
            // Resumen agresivo
            const summaryHtml = `
                <div class="summary">
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="summary-number momentum">${data.summary.exceptional_momentum || 0}</div>
                            <div class="summary-label">Momentum Excepcional</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number aggressive">${data.summary.strong_momentum || 0}</div>
                            <div class="summary-label">Momentum Fuerte</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number rotation">${data.summary.rotation_opportunities || 0}</div>
                            <div class="summary-label">Oportunidades RotaciÃ³n</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number targeting">${data.top_picks ? data.top_picks.length : 0}</div>
                            <div class="summary-label">Targets Agresivos</div>
                        </div>
                    </div>
                </div>
            `;
            
            let analysisHtml = `<div class="analysis-sections">`;
            
            // TOP PICKS con momentum agresivo
            if (data.top_picks && data.top_picks.length > 0) {
                analysisHtml += `
                    <div class="analysis-card">
                        <div class="section-title picks">Top Momentum Picks - Targets Agresivos</div>
                        <div class="top-picks-grid">
                `;
                
                data.top_picks.slice(0, 8).forEach(stock => {
                    const levels = calculateAggressiveTradingLevels(stock);
                    const momentumCategory = getMomentumCategory(stock);
                    const reasoning = generateAggressiveReasoningText(stock, {});
                    
                    analysisHtml += `
                        <div class="pick-card">
                            <div class="pick-header">
                                <div class="pick-symbol">${stock.symbol}</div>
                                <div class="pick-price">$${levels.current.toFixed(2)}</div>
                            </div>
                            <div class="pick-company">${stock.company || 'N/A'} â€¢ ${stock.sector || 'N/A'}</div>
                            
                            <div class="momentum-indicators">
                                <div class="momentum-badge ${momentumCategory.toLowerCase()}">${momentumCategory}</div>
                                <div class="momentum-badge">${stock.rotation_urgency || 'MEDIUM'}</div>
                                <div class="momentum-badge">~1 mes</div>
                            </div>
                            
                            <div class="trading-levels">
                                <div class="level-item">
                                    <div class="level-value current">$${levels.current.toFixed(2)}</div>
                                    <div class="level-label">Precio Actual</div>
                                </div>
                                <div class="level-item">
                                    <div class="level-value stop-loss">$${levels.stopLoss.toFixed(2)}</div>
                                    <div class="level-label">Stop Loss</div>
                                </div>
                                <div class="level-item">
                                    <div class="level-value aggressive">$${levels.takeProfit.toFixed(2)}</div>
                                    <div class="level-label">Target Agresivo</div>
                                </div>
                                <div class="level-item">
                                    <div class="level-value">${levels.riskReward}:1</div>
                                    <div class="level-label">Risk/Reward</div>
                                </div>
                            </div>
                            
                            <div class="pick-metrics">
                                <div class="metric-item">
                                    <div class="metric-value">${((levels.takeProfit - levels.current) / levels.current * 100).toFixed(1)}%</div>
                                    <div class="metric-label">Upside Agresivo</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value">${stock.metrics?.risk_pct?.toFixed(1) || 'N/A'}%</div>
                                    <div class="metric-label">Risk</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value">+${stock.metrics?.outperformance_20d?.toFixed(1) || 'N/A'}%</div>
                                    <div class="metric-label">Momentum 20d (70%)</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value">${stock.score?.toFixed(0) || 'N/A'}</div>
                                    <div class="metric-label">Score Final</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value">${stock.technical_score?.toFixed(0) || 'N/A'}</div>
                                    <div class="metric-label">Score TÃ©cnico</div>
                                </div>
                                <div class="metric-item">
                                    <div class="metric-value">+${stock.rr_bonus?.toFixed(0) || 'N/A'}</div>
                                    <div class="metric-label">Bonus R/R</div>
                                </div>
                            </div>
                            
                            <div class="pick-reasoning">
                                <div class="reasoning-title">âš¡ RazÃ³n para momentum agresivo:</div>
                                <div class="reasoning-text">${reasoning}</div>
                            </div>
                        </div>
                    `;
                });
                
                analysisHtml += `
                        </div>
                    </div>
                `;
            }
            
            // Layout de dos columnas
            analysisHtml += `<div class="two-column">`;
            
            // AnÃ¡lisis de momentum
            if (data.momentum_analysis) {
                analysisHtml += `
                    <div class="analysis-card">
                        <div class="section-title momentum">AnÃ¡lisis de Momentum Agresivo</div>
                        
                        <div class="momentum-grid">
                            <div class="momentum-item">
                                <div class="momentum-number">${data.momentum_analysis.exceptional_momentum?.length || 0}</div>
                                <div class="momentum-label">Momentum Excepcional</div>
                            </div>
                            <div class="momentum-item">
                                <div class="momentum-number">${data.momentum_analysis.strong_momentum?.length || 0}</div>
                                <div class="momentum-label">Momentum Fuerte</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">ðŸ”¥ Momentum EXCEPCIONAL (rotaciÃ³n urgente):</div>
                            <div class="symbol-list">
                                ${(data.momentum_analysis.exceptional_momentum || []).map(symbol => 
                                    `<span class="symbol-badge exceptional">${symbol}</span>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">âš¡ Momentum FUERTE (rotaciÃ³n agresiva):</div>
                            <div class="symbol-list">
                                ${(data.momentum_analysis.strong_momentum || []).map(symbol => 
                                    `<span class="symbol-badge strong">${symbol}</span>`
                                ).join('')}
                            </div>
                        </div>
                        
                        ${data.momentum_analysis.emerging_momentum?.length > 0 ? `
                        <div style="margin-top: 15px;">
                            <div style="font-weight: bold; margin-bottom: 8px;">ðŸŒ± Momentum EMERGENTE (vigilar):</div>
                            <div class="symbol-list">
                                ${data.momentum_analysis.emerging_momentum.map(symbol => 
                                    `<span class="symbol-badge emerging">${symbol}</span>`
                                ).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                `;
            }
            
            // Recomendaciones de rotaciÃ³n agresiva
            if (data.rotation_recommendations) {
                const overallAction = data.rotation_recommendations.overall_action;
                let actionBadgeClass = 'maintain';
                let actionText = 'Mantener con vigilancia';
                
                if (overallAction === 'URGENT_PORTFOLIO_ROTATION') {
                    actionBadgeClass = 'urgent-rotation';
                    actionText = 'RotaciÃ³n urgente de cartera';
                } else if (overallAction === 'AGGRESSIVE_ROTATION_REQUIRED') {
                    actionBadgeClass = 'rotation-required';
                    actionText = 'RotaciÃ³n agresiva requerida';
                } else if (overallAction === 'EVALUATE_MOMENTUM_OPPORTUNITIES') {
                    actionBadgeClass = 'evaluate';
                    actionText = 'Evaluar oportunidades momentum';
                }
                
                analysisHtml += `
                    <div class="analysis-card">
                        <div class="section-title rotation">RotaciÃ³n Agresiva de Momentum</div>
                        
                        <div style="margin-bottom: 15px;">
                            <span class="action-badge ${actionBadgeClass}">${actionText}</span>
                        </div>
                        
                        <div class="rotation-recommendations">
                `;
                
                // Rotaciones urgentes
                if (data.rotation_recommendations.aggressive_rotations?.length > 0) {
                    analysisHtml += `
                        <div class="rotation-section">
                            <div class="rotation-title urgent">Rotaciones Urgentes</div>
                    `;
                    data.rotation_recommendations.aggressive_rotations.forEach(rotation => {
                        analysisHtml += `
                            <div class="recommendation-item urgent">
                                <div class="recommendation-header">
                                    <span class="recommendation-symbol">${rotation.symbol || rotation}</span>
                                    <span class="recommendation-action urgent">ROTAR AHORA</span>
                                </div>
                                <div class="recommendation-reason">${rotation.reason || 'Momentum excepcional detectado'}</div>
                            </div>
                        `;
                    });
                    analysisHtml += `</div>`;
                }
                
                // Salidas urgentes
                if (data.rotation_recommendations.urgent_exits?.length > 0) {
                    analysisHtml += `
                        <div class="rotation-section">
                            <div class="rotation-title urgent">Salidas Urgentes</div>
                    `;
                    data.rotation_recommendations.urgent_exits.forEach(exit => {
                        analysisHtml += `
                            <div class="recommendation-item urgent">
                                <div class="recommendation-header">
                                    <span class="recommendation-symbol">${exit.symbol || exit}</span>
                                    <span class="recommendation-action urgent">SALIR</span>
                                </div>
                                <div class="recommendation-reason">${exit.reason || 'Momentum perdido'}</div>
                            </div>
                        `;
                    });
                    analysisHtml += `</div>`;
                }
                
                // Oportunidades emergentes
                if (data.rotation_recommendations.emerging_opportunities?.length > 0) {
                    analysisHtml += `
                        <div class="rotation-section">
                            <div class="rotation-title emerging">Oportunidades Emergentes</div>
                    `;
                    data.rotation_recommendations.emerging_opportunities.forEach(opp => {
                        analysisHtml += `
                            <div class="recommendation-item emerging">
                                <div class="recommendation-header">
                                    <span class="recommendation-symbol">${opp.symbol || opp}</span>
                                    <span class="recommendation-action emerging">VIGILAR</span>
                                </div>
                                <div class="recommendation-reason">${opp.reason || 'Momentum emergente prometedor'}</div>
                            </div>
                        `;
                    });
                    analysisHtml += `</div>`;
                }
                
                analysisHtml += `
                        </div>
                    </div>
                `;
            }
            
            analysisHtml += `</div>`; // Cerrar two-column
            
            // Contexto de mercado
            if (data.market_context) {
                analysisHtml += `
                    <div class="market-context">
                        <h4>ðŸ“Š Contexto SPY & Momentum Responsivo</h4>
                        <div class="spy-metrics">
                            <div class="spy-metric">
                                <div class="spy-value ${data.market_context.spy_20d >= 0 ? 'positive' : 'negative'}">
                                    ${data.market_context.spy_20d >= 0 ? '+' : ''}${data.market_context.spy_20d.toFixed(1)}%
                                </div>
                                <div class="spy-label">SPY 20 dÃ­as</div>
                            </div>
                            <div class="spy-metric">
                                <div class="spy-value ${data.market_context.spy_60d >= 0 ? 'positive' : 'negative'}">
                                    ${data.market_context.spy_60d >= 0 ? '+' : ''}${data.market_context.spy_60d.toFixed(1)}%
                                </div>
                                <div class="spy-label">SPY 60 dÃ­as</div>
                            </div>
                            <div class="spy-metric">
                                <div class="spy-value ${data.market_context.spy_90d >= 0 ? 'positive' : 'negative'}">
                                    ${data.market_context.spy_90d >= 0 ? '+' : ''}${data.market_context.spy_90d.toFixed(1)}%
                                </div>
                                <div class="spy-label">SPY 90 dÃ­as</div>
                            </div>
                        </div>
                        <div style="margin-top: 15px; padding: 10px; background: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.85em; color: #666;">
                            <strong>âš¡ Momentum Responsivo:</strong> Targets son agresivos pero adaptativos. Si momentum se debilita (no aparece 1+ semanas), salir independientemente del target. RotaciÃ³n mensual activa hacia mejores oportunidades.
                        </div>
                    </div>
                `;
            }
            
            analysisHtml += `</div>`;
            
            // Footer
            const updateTime = new Date(data.timestamp).toLocaleString('es-ES');
            const footerHtml = `
                <div class="last-update">
                    ðŸ“… Ãšltima actualizaciÃ³n: ${updateTime}<br>
                    ðŸ—“ï¸ Fecha de anÃ¡lisis: ${data.market_date}<br>
                    â° PrÃ³ximo anÃ¡lisis: ${getNextUpdateTime()}<br>
                    ðŸ“… EjecuciÃ³n automÃ¡tica: SÃ¡bados 10 AM EspaÃ±a<br>
                    <div class="signature">
                        <small>ðŸ“Š Professional Momentum Analytics Platform by <strong>0t4c0n</strong></small>
                    </div>
                </div>
            `;
            
            contentEl.innerHTML = summaryHtml + analysisHtml + footerHtml;
        }
        
        // Cargar datos al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
        
        // Auto-refresh cada 5 minutos si estÃ¡ activo
        setInterval(() => {
            if (document.hasFocus()) {
                loadData();
            }
        }, 5 * 60 * 1000);
    </script>
</body>
</html>